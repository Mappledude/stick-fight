<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    >
    <title>Stick-Fight — Shell</title>
    <style>
      :root {
        --safe-area-inset-top: env(safe-area-inset-top);
        --safe-area-inset-right: env(safe-area-inset-right);
        --safe-area-inset-bottom: env(safe-area-inset-bottom);
        --safe-area-inset-left: env(safe-area-inset-left);
      }

      html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        background: #000;
        color: #fff;
        overflow: hidden;
        touch-action: none;
        overscroll-behavior: none;
        -webkit-user-select: none;
        user-select: none;
      }

      #room-border {
        position: fixed;
        top: var(--safe-area-inset-top);
        right: var(--safe-area-inset-right);
        bottom: var(--safe-area-inset-bottom);
        left: var(--safe-area-inset-left);
        border: 2px solid #fff;
        border-radius: 8px;
        background: #000;
        overflow: hidden;
        box-sizing: border-box;
      }

      #game-root {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
      }

      .stage-line {
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        border-top: 2px solid #fff;
        opacity: 0.85;
        pointer-events: none;
        transform: translateY(-1px);
      }

      canvas {
        display: block;
        width: 100%;
        height: 100%;
        touch-action: none;
        overscroll-behavior: none;
        -webkit-user-select: none;
        user-select: none;
      }

      #boot-overlay {
        position: fixed;
        z-index: 9999;
        top: calc(var(--safe-area-inset-top) + 16px);
        right: calc(var(--safe-area-inset-right) + 16px);
        min-width: 240px;
        max-width: min(360px, 90vw);
        color: #fff;
        font-family: 'Segoe UI', Roboto, sans-serif;
        background: rgba(15, 15, 20, 0.88);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 12px;
        padding: 12px 16px 16px 16px;
        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.45);
        backdrop-filter: blur(6px);
        pointer-events: none;
      }

      #boot-overlay[hidden] {
        display: none;
      }

      .boot-overlay__badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 4px 10px;
        border-radius: 999px;
        font-size: 12px;
        font-weight: 600;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        background: rgba(0, 122, 255, 0.22);
        border: 1px solid rgba(0, 122, 255, 0.5);
      }

      .boot-overlay__status {
        list-style: none;
        margin: 12px 0 0 0;
        padding: 0;
        display: grid;
        gap: 6px;
        font-size: 13px;
        line-height: 1.45;
        max-height: 200px;
        overflow: hidden;
      }

      .boot-overlay__status-item {
        display: flex;
        align-items: flex-start;
        gap: 8px;
        opacity: 0.88;
      }

      .boot-overlay__status-item::before {
        content: '';
        width: 6px;
        height: 6px;
        border-radius: 999px;
        margin-top: 6px;
        background: rgba(0, 168, 255, 0.9);
        flex-shrink: 0;
      }

      .boot-overlay__status-item[data-boot-tag='ERROR']::before {
        background: rgba(255, 77, 77, 0.95);
      }

      .boot-overlay__status-item em {
        font-style: normal;
        opacity: 0.65;
        font-size: 11px;
        display: inline-block;
        margin-right: 4px;
      }

      .boot-overlay__error {
        margin: 12px 0 0 0;
        padding: 10px 12px;
        border-radius: 10px;
        font-size: 12px;
        line-height: 1.4;
        background: rgba(255, 56, 56, 0.15);
        border: 1px solid rgba(255, 56, 56, 0.55);
        color: #ffe1e1;
        white-space: pre-wrap;
        word-break: break-word;
      }

      .boot-overlay__error[hidden] {
        display: none;
      }

      #boot-debug-drawer {
        position: fixed;
        z-index: 10000;
        bottom: calc(var(--safe-area-inset-bottom) + 16px);
        right: calc(var(--safe-area-inset-right) + 16px);
        width: min(360px, 40vw);
        max-width: 420px;
        font-family: 'Segoe UI', Roboto, sans-serif;
        color: #fff;
        background: rgba(10, 10, 15, 0.88);
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 12px;
        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.45);
        backdrop-filter: blur(6px);
        overflow: hidden;
        pointer-events: auto;
      }

      #boot-debug-drawer .boot-debug-drawer__header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
        padding: 10px 12px;
        background: rgba(255, 255, 255, 0.05);
      }

      #boot-debug-drawer button {
        font-family: inherit;
        font-size: 12px;
        line-height: 1.2;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        border-radius: 999px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        padding: 6px 12px;
        color: #fff;
        background: rgba(0, 0, 0, 0.35);
        cursor: pointer;
        pointer-events: auto;
      }

      #boot-debug-drawer button:focus {
        outline: 2px solid rgba(0, 168, 255, 0.6);
        outline-offset: 2px;
      }

      #boot-debug-drawer button:hover {
        background: rgba(255, 255, 255, 0.15);
      }

      #boot-debug-drawer .boot-debug-drawer__body {
        display: flex;
        flex-direction: column;
        gap: 8px;
        padding: 12px;
      }

      #boot-debug-drawer[data-open='false'] .boot-debug-drawer__body {
        display: none;
      }

      #boot-debug-drawer .boot-debug-drawer__textarea {
        width: 100%;
        min-height: 160px;
        max-height: 40vh;
        resize: vertical;
        border-radius: 8px;
        border: 1px solid rgba(255, 255, 255, 0.18);
        background: rgba(0, 0, 0, 0.5);
        color: #e2e8f0;
        padding: 10px;
        font-family: 'SFMono-Regular', Menlo, Consolas, 'Liberation Mono', monospace;
        font-size: 12px;
        line-height: 1.4;
        pointer-events: auto;
        -webkit-user-select: text;
        user-select: text;
        overflow: auto;
        box-sizing: border-box;
      }

      #boot-debug-drawer .boot-debug-drawer__textarea:focus {
        outline: 2px solid rgba(0, 168, 255, 0.45);
        outline-offset: 2px;
      }
    </style>
    <script src="boot.js"></script>
    <script defer src="/__/firebase/10.12.2/firebase-app-compat.js"></script>
    <script defer src="/__/firebase/10.12.2/firebase-auth-compat.js"></script>
    <script defer src="/__/firebase/10.12.2/firebase-firestore-compat.js"></script>
    <script defer src="/__/firebase/init.js"></script>
    <script>
      console.info('[HTML] configScript=present bundleOrder=ok');
    </script>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>
    <script src="joydiag-config.js" defer></script>
    <script type="module" src="firebase-config.js"></script>
    <script type="module" src="firebase-bootstrap.js"></script>
    <script src="net.js" defer></script>
    <script src="net-server.js" defer></script>
    <script src="netplay.js" defer></script>
    <script src="main.js" defer></script>
  </head>
  <body>
    <div id="boot-overlay" hidden>
      <div class="boot-overlay__badge" data-boot-badge>Booting…</div>
      <ul class="boot-overlay__status" data-boot-status></ul>
      <pre class="boot-overlay__error" data-boot-error hidden></pre>
    </div>
    <div id="room-border">
      <div class="stage-line"></div>
      <div id="game-root"></div>
    </div>
  </body>
</html>
